<!doctype html><html><head><meta charset="utf-8"/><title>Resilience Map</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>#map{height:92vh}</style></head><body>
<div id="map"></div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('map').setView([39.5,-98.35], 4);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom: 18}).addTo(map);
fetch('resilience.geojson').then(r=>r.json()).then(gj=>{
  function getColor(s){ // simple quantiles
    const v = s==null?null:parseFloat(s);
    if (v==null || isNaN(v)) return '#cccccc';
    if (v>1.5) return '#08306b';
    if (v>0.5) return '#2171b5';
    if (v>-0.5) return '#6baed6';
    if (v>-1.5) return '#c6dbef';
    return '#eff3ff';
  }
  L.geoJSON(gj, {
    style: f => ({color:'#999', weight: 0.2, fillOpacity: 0.9, fillColor: getColor(f.properties.resilience_score)}),
    onEachFeature: (f, layer) => {
      const p=f.properties;
      const html = '<b>Tract:</b> '+(p.GEOID||'')+'<br/>' +
                   '<b>Resilience z:</b> '+(p.resilience_score?.toFixed? p.resilience_score.toFixed(2) : p.resilience_score) + '<br/>' +
                   '<b>Burden:</b> '+(p.burden||'') + '<br/>' +
                   '<b>Resid:</b> '+(p.resid||'');
      layer.bindPopup(html);
    }
  }).addTo(map);
});
</script></body></html>